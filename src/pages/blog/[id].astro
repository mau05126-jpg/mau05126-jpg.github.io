---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  
  return posts.map(post => ({
    params: { 
      id: post.slug  
    },
    props: {
      post
    }
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();

const { title, description, pubDate, author, image, tags } = post.data;
---

<Layout title={title}>
  <div class="bg-gray-50 min-h-screen pt-16">
    <div class="max-w-3xl mx-auto px-4 pb-8">
      <article class="bg-white rounded-lg shadow-md overflow-hidden">
        {image && (
          <div class="relative h-64 md:h-80 overflow-hidden">
            <img 
              src={image} 
              alt={title}
              class="w-full h-full object-cover"
              loading="eager"
            />
          </div>
        )}
        
        <div class="p-6 md:p-10">
          <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-3 leading-tight">
            {title}
          </h1>
          <p class="text-lg text-gray-600 mb-6">{description}</p>
        
      <div class="px-8 md:px-12 pb-8 border-b border-gray-200">
        <div class="flex flex-wrap items-center gap-6 text-sm text-gray-600">
          <div class="flex items-center space-x-6">
            <div class="flex items-center text-blue-600">
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
              </svg>
              <span class="font-semibold">{pubDate.toLocaleDateString('es-ES', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
              })}</span>
            </div>
            
            {author && (
              <div class="flex items-center text-gray-700">
                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                </svg>
                <span class="font-medium">{author}</span>
              </div>
            )}
          </div>
          
          <a 
            href="/blog" 
            class="inline-flex items-center px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors"
          >
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
            </svg>
            Volver al Blog
          </a>
        </div>
      </div>

      <div class="px-8 md:px-12 py-10">
        <div class="prose prose-lg max-w-none text-gray-700 text-justify prose-headings:text-gray-900 prose-headings:text-left prose-h2:text-3xl prose-h2:font-bold prose-h2:mt-8 prose-h2:mb-4 prose-h2:border-b-2 prose-h2:border-blue-500 prose-h2:pb-2 prose-h3:text-2xl prose-h3:font-semibold prose-h3:mt-6 prose-h3:mb-3 prose-p:mb-5 prose-p:leading-relaxed prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline prose-strong:text-gray-900 prose-strong:font-semibold prose-ul:my-5 prose-ul:text-left prose-ol:my-5 prose-ol:text-left prose-li:mb-2 prose-img:rounded-xl prose-img:my-8 prose-img:shadow-lg prose-blockquote:border-l-4 prose-blockquote:border-blue-500 prose-blockquote:pl-4 prose-blockquote:italic prose-blockquote:text-gray-600 prose-blockquote:bg-blue-50 prose-blockquote:py-3 prose-code:bg-gray-100 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:text-sm prose-code:text-red-600 prose-code:font-mono prose-pre:bg-gray-900 prose-pre:text-gray-100 prose-pre:p-6 prose-pre:rounded-xl prose-pre:overflow-x-auto">
          <Content />
        </div>
      </div>

      {tags && tags.length > 0 && (
        <div class="px-8 md:px-12 pb-8">
          <div class="flex flex-wrap gap-2">
            {tags.map(tag => (
              <span class="px-4 py-2 bg-blue-50 text-blue-700 text-sm font-medium rounded-lg border border-blue-200 hover:bg-blue-100 transition-colors">
                #{tag}
              </span>
            ))}
          </div>
        </div>
      )}
    </article>
  </div>
</Layout>